%%%%%%%%%%%%
\section{Cut Property and Cycle Property}

%%%%%%%%%%%%%
\begin{frame}{Cut property of MST}
  \begin{exampleblock}{Cut Property \pno{3.6.18 (a)}}
    \begin{itemize}
	  \item Graph $G = (V, E)$ (undirected, connected, weighted)
	  \item \textcolor{gray}{Weights are distinct}
	  \item A cut $(S, V \setminus S)$ where $S, V-S \neq \emptyset$
	  \item Let $e = (u,v)$ be \emph{a} minimum-weight edge across $(S, V \setminus S)$
	\end{itemize}
	Then $e$ must be in \emph{some} MST of $G$.
  \end{exampleblock}

  \fignocaption{width = 0.35\textwidth}{fig/cut-property-no-name.pdf}
\end{frame}
%%%%%%%%%%%%%
\begin{frame}{Cut property of MST}
  \begin{block}{Cut Property \pno{3.6.18 (a)}}
    \begin{proof}
      Basic idea: $T$ is an MST of $G$.
      \begin{itemize}
	\item $e \in T$
	\item $e \notin T \Rightarrow e \in T'$
	  \begin{itemize}
	    \item $T + \set{e}$ to construct a cycle $C$
	    \item $\exists e' = (u',v') \in C$ ($e' \in P_{u,v}$), $e'$ crosses $(S, V \setminus S)$
	    \item $T' = T + \set{e} - \set{e'}$: spanning tree (connected, acyclic)
	    \item $w(e') \geq w(e) \Rightarrow w(T') \le w(T) \Rightarrow w(T') = w(T)$
	  \end{itemize}
      \end{itemize}
    \end{proof}
  \end{block}

  \begin{alertblock}{Remark.}
    \begin{itemize}
      \item a minimum-weight edge; $\in$ some MST
      \item exchange argument
    \end{itemize}
  \end{alertblock}
\end{frame}
%%%%%%%%%%%%%
\begin{frame}{Cut property of MST}
  \begin{exampleblock}{Application of cycle property \pno{3.6.15}}
    \begin{itemize}
      \item \pno{3.6.15 (3)}: $e \in G$ is a lightest edge $\Rightarrow$ $e \in \exists$ MST of $G$
      \item \pno{3.6.15 (4)}: $e \in G$ is the unique lightest edge $\Rightarrow$ $e \in \forall$ MST
      \item \pno{3.6.15 (9)}: $e = (u,v) \in \exists$ MST $T$ of $G$ $\Rightarrow$ $e$ is a lightest edge across some cut $(S, V \setminus S)$ \emph{(converse of cut property)}
    \end{itemize}
  \end{exampleblock}

  \begin{block}{Solution.}
    \begin{itemize}
      \item \pno{3.6.15 (3)}: $(S=\set{u}, V \setminus S)$
      \item \pno{3.6.15 (4)}: By contradiction. $e \notin T$; $T' = T + \set{e} - \set{e'} \Rightarrow w(T') < w(T)$
      \item \pno{3.6.15 (9)}: 
	\begin{enumerate}
	  \item to find the cut $(S, V \setminus S)$
	    \begin{itemize}
	      \item $T - \set{e}$
	    \end{itemize}
	  \item to prove that $e$ is a lightest edge across $(S, V \setminus S)$
	    \begin{itemize}
	      \item by contradiction: $T' = T - \set{e} + \set{e'}$
	    \end{itemize}
	\end{enumerate}
    \end{itemize}
  \end{block}
\end{frame}
%%%%%%%%%%%%%
\begin{frame}{Cut property of MST}
  \begin{exampleblock}{Wrong divide-and-conquer algorithm for MST \pno{3.6.29}}
    \begin{itemize}
      \item $G = (V, E, w)$
      \item $(V_{1}, V_{2}): ||V_{1}| - |V_{2}|| \le 1$
      \item $T_{1} + T_{2} + \set{e}$: $e$ is a lightest edge across $(V_{1}, V_{2})$
    \end{itemize}
  \end{exampleblock}

  \begin{block}{Solution.}
    \fignocaption{width = 0.30\textwidth}{fig/divide-conquer-mst-counterexample.pdf}
  \end{block}
\end{frame}
%%%%%%%%%%%%%
\begin{frame}{Cycle property of MST}
  \begin{block}{Cycle property \pno{3.6.18 (b)}}
	\begin{itemize}
	  \item $G = (V,E,w)$
	  \item Let $C$ be any cycle in $G$
	  \item $e = (u,v)$ is \emph{a} maximum-weight edge in $C$
	\end{itemize}
	Then $\exists \textrm{ MST } T \text{ of } G: e \notin T$.
  \end{block}

  \fignocaption{width = 0.40\textwidth}{fig/cycle-property.pdf}
\end{frame}
%%%%%%%%%%%%%
\begin{frame}{Cycle property of MST}
  \begin{block}{Cycle property \pno{3.6.18 (b)}}
    \begin{proof}
      Basic idea: pick any MST $T$ of $G$
      \begin{itemize}
	\item $e \notin T$
	\item $e \in T \Rightarrow e \notin T'$
	  \begin{itemize}
	    \item $T - \set{e}$ $\Rightarrow$ $(S, V \setminus S)$
	    \item $\exists e' = (u', v') \in C$ ($e' \in P_{u,v}$) across the cut
	    \item \textcolor{red}{$T' = T - \set{e} + \set{e'}$}: spanning tree
	    \item $w(e') \leq w(e) \Rightarrow w(T') \leq w(T) \Rightarrow w(T') = w(T)$
	  \end{itemize}
      \end{itemize}
    \end{proof}
  \end{block}

  \begin{alertblock}{Remark.}
    \begin{itemize}
      \item Why don't we pick any $e' \in C$?
      \item ``Anti-Kruskal'' (reverse-delete; also by Kruskal) \pno{3.6.20 (c)}
    \end{itemize}
  \end{alertblock}
\end{frame}
%%%%%%%%%%%%%
\begin{frame}{Applications of cycle property}
  \begin{exampleblock}{Applications of cycle property \pno{3.6.15}}
    \begin{itemize}
      \item \pno{3.6.15 (2)}: $C \subseteq G, e \in C$, $e$ is the unique maximum-weighted edge of $G$ $\Rightarrow$ $e \notin$ any MST of $G$
      \item \pno{3.6.15 (5); 3.6.18 (c)}: $C \subseteq G, e \in C$, $e$ is the unique lightest edge of $C$ $\Rightarrow^{?} e \in \forall$ MST
      \item \pno{3.6.15 (1)}: $G = (V, E), |E| > |V| - 1$, $e$ unique maximum-weighted edge $\Rightarrow^{?} e \notin$ any MST
      \item \pno{3.6.20 (a)}: $e$ does not belong to any cycle $\Rightarrow$ $e \in \forall$ MST
    \end{itemize}
  \end{exampleblock}

  \begin{block}{Solution.}
    \begin{itemize}
      \item \pno{3.6.15 (2)}: By contradiction. $T' = T - \set{e} + \set{e'}$
      \item \pno{3.6.15 (5); 3.6.18 (c)}
	\fignocaption{width = 0.20\textwidth}{fig/cycle-property-inverse.pdf}
      \item \pno{3.6.15 (1)}: (bridge)
      \item \pno{3.6.20 (a)}: disconnected o.w.
    \end{itemize}
  \end{block}
\end{frame}
%%%%%%%%%%%%%
\begin{frame}{Properties of MST}
  \begin{exampleblock}{\cmark or \xmark \pno{3.6.15}}
    \begin{enumerate}
      \item \xmark $|E| > |V| - 1$, $e$ is the unique maximum edge $\Rightarrow$
      $e$ does not belong to any MST.
      \item \cmark If $G$ has a cycle with a unique maximum edge $e$, then $e$ cannot
      be part of any MST. (\textcolor{blue}{Prove}: Cycle property)
      \item \cmark Let $e$ be any edge of minimum edge in $G$. Then $e$ belongs to
      some MST. (\textcolor{blue}{Prove}: Cut property)
      \item \cmark If the minimum edge is unique, then it belongs to every MST.
      \item \xmark If $G$ has a cycle with a unique minimum edge $e$, then $e$
      belongs to every MST.
	\fignocaption{width = 0.20\textwidth}{fig/cycle-property-inverse.pdf}
	  \newcounter{enumTemp}
      \setcounter{enumTemp}{\theenumi}
    \end{enumerate}
  \end{exampleblock}
\end{frame}
%%%%%%%%%%%%%
\begin{frame}{Properties of MST}
  \begin{exampleblock}{\cmark or \xmark \pno{3.6.15}}
    \begin{enumerate}
      \setcounter{enumi}{\theenumTemp}
      \item \xmark The shortest-path tree computed by Dijkstra's algorithm is
      necessarily an MST.
      \item \xmark The shortest path between two nodes is necessarily part of some
      MST.
      \fignocaption{width = 0.10\textwidth}{fig/mst-sssp.pdf}
      \item \cmark Prim's algorithm works correctly when there are negative edges.
      \item \cmark If $e$ belongs to some MST, then $e$ is a minimum edge across some
      cut.
      \item \cmark $w > 0$; Vertex $s$; shortest-path tree of $s$ and some MST share
      a common edge
      \pno{6.1.5}
      \item \cmark $w'(e) = \left(w(e)\right)^2$ \pno{6.2.2}
    \end{enumerate}
  \end{exampleblock}
\end{frame}
%%%%%%%%%%%%
\begin{frame}{Uniqueness of MST}
  \begin{exampleblock}{Uniqueness of MST \pno{3.6.21}}
    Distinct weights $\Rightarrow$ unique MST.
  \end{exampleblock}

  % \fignocaption{width = 0.35\textwidth}{fig/mst-unique.pdf}
  \begin{block}{Solution.}
    \begin{proof}
      By contradiction: two MSTs $T_1 \neq T_2$.
      \begin{itemize}
	\item $\Delta E = \set{e \mid e \in T_1 \setminus T_2 \lor e \in T_2
	  \setminus T_1}$
	\item $e = \min \Delta E$. Suppose $e \in T_1 \setminus T_2$
	\item $T_2 + \set{e} \Rightarrow C$
	\item $\exists (e' \in C) \notin T_1 \Rightarrow e' \in T_{2} \setminus T_{1} \Rightarrow e' \in \Delta E \Rightarrow w(e') > w(e)$
	\item $e' \in T_{2} \setminus T_{1} \Rightarrow e' \in \Delta E$
	\item $T' = T_{2} + \set{e} - \set{e'} \Rightarrow w(T') < w(T_{2})$
      \end{itemize}
    \end{proof}
  \end{block}
\end{frame}
%%%%%%%%%%%%%
\begin{frame}{Uniqueness of MST}
  \begin{block}{Conditions for Uniqueness of MST \pno{3.6.19}}
    \begin{itemize}
      \item \pno{3.6.19 (a)}: unique MST $\nRightarrow$ equal weights
        \fignocaption{width = 0.20\textwidth}{fig/unique-mst-partition.pdf}
      \item \pno{3.6.19 (c)}: Counterexamples
        \begin{itemize}
          \item \xmark cut: minimum-weight edge across any cut is unique
          \item \xmark cycle: maximum-weight edge in any cycle is unique
        \end{itemize}
        \begin{columns}
          \column{0.50\textwidth}
            \fignocaption{width = 0.40\textwidth}{fig/unique-mst-partition.pdf}
          \column{0.50\textwidth}
            \fignocaption{width = 0.45\textwidth}{fig/unique-mst-cycle.pdf}
        \end{columns}
    \end{itemize}
  \end{block}
\end{frame}
%%%%%%%%%%%%
\section{Updating MST}

%%%%%%%%%%%%
\begin{frame}{Updating MST}
  \begin{exampleblock}{Decreasing/increasing edge weight \pno{3.6.6}}
    $G$ and an MST $T$
    \begin{enumerate}
      \item $w(e)$ is decreased: $w'(e) = w(e) - k$
      \item $w(e)$ is increased
    \end{enumerate}
  \end{exampleblock}

  \begin{block}{Solution for (1).}
    \begin{itemize}
      \item $e \in T$: no need to update $T' = T$.
	$w'(T') = w(T) - k \Rightarrow w'(T') < w(T)$.

	To prove that $T'$ is an MST of $G'$:

	Suppose $\exists T'':$ $T''$ is an ST of $G'$ and $w'(T'') < w'(T')$.
	\begin{itemize}
	  \item $e \notin T''$: $w(T'') = w'(T'') < w'(T') < w(T)$
	  \item $e \in T''$: $w(T'') = w'(T'') + k < w'(T') + k = w(T)$
	\end{itemize}
      \item $e \notin T$: $T' = T + \set{e} - \set{e'}$; $e'$ is the
	maximum-weight edge in cycle and $w(e') > w(e)$
	\begin{itemize}
	  \item $e \notin T''$: $w(T'') = w'(T'') < w'(T') < w(T)$
	  \item $e \in T''$: \textcolor{red}{???}
	\end{itemize}
    \end{itemize}
  \end{block}

  \textcolor{red}{To verify it:} \url{http://cs.stackexchange.com/q/43309/4911}
\end{frame}
%%%%%%%%%%%%
\begin{frame}{Updating MST}
  \begin{exampleblock}{Adding vertex to MST \pno{3.6.2}}
    \begin{itemize}
      \item $G = (V,E)$; an MST $T$
      \item $G' = (V',E')$: $V' = V + \set{X}, E' = E + E_X$; $E_X$: incident
      edges to $X$
      \item To find an MST $T'$ of $G'$
    \end{itemize}
  \end{exampleblock}

  \begin{block}{Solution.}
    \begin{enumerate}
      \item Recomputing $O((m+n) \log n)$
      \item
        \begin{itemize}
          \item There \emph{exists} an MST of $G'$ that includes no edges in $G
          \setminus T$
          \item Run MST alg. on $G'' =(V + \set{X}, T + E_X)$
          \item $O(n \log n)$
        \end{itemize}
      \item $O(n)$
        \begin{itemize}
          \item ``On Finding and Updating Spanning Tress and Shortest Paths'', 1975
          \item ``Algorithms for Updating Minimum Spanning Trees'', 1978
        \end{itemize}
    \end{enumerate}
  \end{block}
\end{frame}
%%%%%%%%%%%%%
\section{Variants of MST}

%%%%%%%%%%%%%
\begin{frame}{Variants of MST}
  \begin{exampleblock}{Feedback edge set: \pno{3.6.4}}
    \begin{enumerate}
      \item maximum spanning tree
      \item (minimum) feedback edge set:
	\begin{itemize}
	  \item a set of edges which, when removed from the graph, leave an acyclic graph $G'$
	  \item assuming $G$ is connected $\Rightarrow$ $G'$ is connected
	  \item feedback \emph{arc} set: ``cycle'' $\Rightarrow$ circular dependency
	\end{itemize}
    \end{enumerate}
  \end{exampleblock}

  \begin{block}{Solution.}
    \begin{itemize}
      \item $G'$ is connected + acyclic $\Rightarrow$ $G'$ is an ST
      \item $\textrm{FES} \Leftrightarrow G \setminus \textrm{Max-ST}$
    \end{itemize}
  \end{block}
\end{frame}
%%%%%%%%%%%%
\begin{frame}{Variants of MST}
  \begin{exampleblock}{Edge weights \pno{3.6.15 (8); 3.6.16}}
    \begin{itemize}
      \item \pno{3.6.15 (8)}: negative edges for Prim algorithm
      \item \pno{3.6.16}: $w'(e) = (w(e))^{2}$
    \end{itemize}
  \end{exampleblock}
\end{frame}
%%%%%%%%%%%%%
\begin{frame}{Variants of MST}
  \begin{exampleblock}{MST with specified leaves: \pno{3.6.7}}
    \begin{itemize}
      \item $G = (V, E), U \subset V$
      \item finding an MST with $U$ as leaves
    \end{itemize}
  \end{exampleblock}

  \begin{block}{Solution.}
    \begin{columns}
      \column{0.60\textwidth}
	\begin{itemize}
	  \item $G' = G \setminus U$
	  \item MST $T'$ of $G'$
	  \item attach $\forall u \in U$ to $T'$ (lightest edge)
	\end{itemize}
      \column{0.40\textwidth}
	\fignocaption{width = 0.50\textwidth}{fig/mst-specified-leaves.pdf}
    \end{columns}
  \end{block}
\end{frame}
%%%%%%%%%%%%
\begin{frame}{Variants of MST}
  \begin{block}{ST with specified edges: \pno{3.6.10}}
    \begin{itemize}
      \item $G = (V,E), S \subset E$ (no cycle in S)
      \item finding an MST with $E$ as edges
    \end{itemize}
  \end{block}

  \begin{block}{Solution.}
    \begin{itemize}
      \item contract each isolated component of $S$ to a \emph{super-vertex}
      \item $G \to G'$
      \item find MST of $G'$
    \end{itemize}
  \end{block}
\end{frame}
%%%%%%%%%%%%%
\section{MST vs. Shortest Paths}

%%%%%%%%%%%%%
\begin{frame}{MST vs. shortest paths}
  \begin{exampleblock}{\pno{3.6.15}}
     \begin{itemize}
       \item \pno{3.6.15 (6)}: Dijkstra $\Rightarrow$ SSSP tree $\Rightarrow^{?}$ MST
       \item \pno{3.6.15 (7)}: $s \to t$ shortest path $\Rightarrow^{?} \subseteq \exists \text{ MST}$
     \end{itemize}
  \end{exampleblock}
\end{frame}
%%%%%%%%%%%%%
\begin{frame}{MST vs. shortest paths}
  \begin{exampleblock}{Sharing edges \pno{3.6.5}}
    \begin{itemize}
      \item $G = (V, E), w(e) > 0$
      \item Given $s$: all sssp trees from $s$ must share some edge with \textcolor{red}{all} (\textcolor{gray}{some}) MSTs of $G$
    \end{itemize}
  \end{exampleblock}

  \begin{block}{Solution}
    $E'$: lightest edges leaving $s$
    \begin{itemize}
      \item any MST $T$ of $G$: $T \cap E' \neq \emptyset$
      \item $E' \subset \forall \text{ sssp trees}$
    \end{itemize}
  \end{block}
\end{frame}
%%%%%%%%%%%%%
